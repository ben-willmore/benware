== PLANS

* Faster for short stimuli -- HOW? (and are we slower than brainware still?)
  -- numerous small optimisations are possible (and worthwhile) but turning plotting off
     make a big difference (quning from 0.6+ to 0.3+ sec per sweep). Need to investigate 
     saving of the mat file, which does take longer and longer through a grid.

* Not actually catching ctrl-c and handling file closing -- works for errors only
  -- investigate onCleanup

* Saving sweeps structure as separate files (is saving it slow?)

* VAS?

* Clean up parameters of runSweep

* init TDT devices in a function, remove post-init pause if nothing done(?)

* post-init pause may no longer be necessary

* Offer to append data to existing directory if grid and penetration match.
  OR have a way of continuing an interrupted grid.

* Ability to plot filtered data on scope trace

* Ability to plot averaged LFP signal

* Ability to not save data?

* Save expt structure somewhere

* UI for modifying expt structure

* UI for seeing incoming data - F for filtered, R for raw, etc.

* Set which channel is selected on audio monitor of RZ5


* ontehfly: List directories in date order and default to most recent


== ON HOLD

* stereoPlay16bit -- is it OK to lose resolution? we don't really know

* Compensate stimuli on TDT (saves 50% stimulus upload time).
  Can be done through matlab, no RPVDS req'd
  -- it's too slow! RX6 can cope at 50k but not 100k. See calibplay.rcx

== DONE

* Save data during sweep, not afterwards

* Check that SAVED data exactly matches TDT buffer when checkData is true

* Grids for sparseness/highlights

* UI for choosing grid

* Why is having data as a {} faster than a []? This suggests that something
  can be fixed, and then it will be faster than both.

* Fixed ylim on scope trace

* Scope trace using linspace for a fixed number of points

* Show spikes in scope if there are not too many

* Save spike data for each sweep in a separate file (saving is too slow when
  there are lots of spikes)

* Work out how many samples we should actually expect from TDT, and set data buffer
  to the appropriate size. At the moment, we're messing with +/- because the TDT's
  algorithm isn't quite obvious. It can't be that hard either (ceil,floor or
  round)
  -- thinking about it:
  * We know that you get the expected number when the sweep is a round number
  of seconds
  * We know that you get expected number - 1 otherwise.
  -- I'm pretty sure this adds up to simply floor() rather than ceil()

* On error, close all files and diary

* More careful checks of device status in stim/dataDeviceInit and ZBusInit,
  e.g. check RCX circuit using a fake tag, and any circuit status stuff necessary. Be paranoid!

* Get rid of nSamples from the saving code, and just save the 
  whole lot (which will no longer have a trailing zero)

* Store fs_in and fs_out in one of the data structures

* Include data filenames in sweepInfo.mat (this happens naturally if runSweep
  is informed about which files to use by benWare.m), which itself happens
  naturally in runSweep has to save data during the sweep

* Neil's TDT error in log from expt 30

* Make sure stimulus device knows how long the stimulus is and doesn't play junk samples at the end --
  or truncate long stimuli come to that (i.e. when stimulus length changes within grid)

* Is stereoplay actually behaving correctly re the above?
